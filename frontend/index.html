<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Resume Screening â€“ Phase X</title>

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px 0;
}

.container {
  background: #ffffff;
  width: 520px;
  padding: 28px;
  border-radius: 16px;
  box-shadow: 0 25px 50px rgba(0,0,0,0.3);
}

h1 {
  margin: 0;
  text-align: center;
  color: #2c5364;
}

.subtitle {
  text-align: center;
  font-size: 13px;
  color: #666;
  margin-bottom: 20px;
}

textarea {
  width: 100%;
  height: 120px;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  resize: none;
  margin-bottom: 15px;
}

.upload-box {
  border: 2px dashed #2c5364;
  padding: 14px;
  border-radius: 12px;
  text-align: center;
  margin-bottom: 16px;
}

button {
  width: 100%;
  padding: 12px;
  background: #2c5364;
  color: #fff;
  border: none;
  border-radius: 10px;
  font-size: 15px;
  cursor: pointer;
}

button:hover {
  background: #203a43;
}

.status {
  margin-top: 10px;
  font-size: 13px;
  color: #d9534f;
  text-align: center;
}

/* ---------- RESULTS ---------- */

.result {
  margin-top: 22px;
  display: none;
}

.score {
  text-align: center;
  font-size: 20px;
  font-weight: bold;
}

.badge {
  text-align: center;
  margin: 8px 0;
  padding: 6px;
  border-radius: 8px;
  font-weight: bold;
}

.shortlist { background: #d4edda; color: #155724; }
.review { background: #fff3cd; color: #856404; }
.reject { background: #f8d7da; color: #721c24; }

.progress-box {
  background: #eee;
  border-radius: 10px;
  overflow: hidden;
  margin: 12px 0;
}

.progress-bar {
  height: 18px;
  width: 0%;
  background: linear-gradient(90deg, #00c6ff, #0078d4);
  transition: width 0.8s;
}

.section {
  margin-top: 14px;
}

.section h4 {
  margin-bottom: 6px;
  font-size: 14px;
}

/* ðŸ”¥ KEY FIX */
.summary-box {
  background: #f7f7f7;
  border-radius: 10px;
  padding: 12px;
  font-size: 13px;
  line-height: 1.5;
  max-height: 140px;
  overflow-y: auto;
}

.skills {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.skill {
  padding: 5px 10px;
  border-radius: 14px;
  font-size: 12px;
}

.matched { background: #d4edda; }
.missing { background: #f8d7da; }

footer {
  text-align: center;
  font-size: 11px;
  color: #888;
  margin-top: 18px;
}
</style>
</head>

<body>

<div class="container">
  <h1>AI Resume Screening</h1>
  <div class="subtitle">Phase X â€“ Recruiter Decision Intelligence</div>

  <textarea id="jd" placeholder="Paste Job Description here..."></textarea>

  <div class="upload-box">
    <input type="file" id="resume" accept=".pdf,.docx">
    <small>PDF or DOCX only</small>
  </div>

  <button onclick="analyze()">Analyze Resume</button>
  <div id="status" class="status"></div>

  <div class="result" id="result">
    <div class="score" id="scoreText"></div>
    <div class="badge" id="verdictBadge"></div>

    <div class="progress-box">
      <div class="progress-bar" id="bar"></div>
    </div>

    <div class="section">
      <h4>Resume Summary</h4>
      <div class="summary-box" id="summary"></div>
    </div>

    <div class="section">
      <h4>Matched Skills</h4>
      <div class="skills" id="matched"></div>
    </div>

    <div class="section">
      <h4>Missing Skills</h4>
      <div class="skills" id="missing"></div>
    </div>

    <div class="section">
      <h4>Improvement Suggestions</h4>
      <ul id="suggestions"></ul>
    </div>
  </div>

  <footer>AI Resume Screening â€¢ Phase X</footer>
</div>

<script>
function analyze() {
  const jd = document.getElementById("jd").value;
  const file = document.getElementById("resume").files[0];
  const status = document.getElementById("status");

  if (!jd || !file) {
    status.innerText = "Please upload resume and job description";
    return;
  }

  status.innerText = "Analyzing resume...";
  document.getElementById("result").style.display = "none";

  const formData = new FormData();
  formData.append("resume", file);
  formData.append("jd", jd);

  fetch("http://127.0.0.1:5000/api/ai-analyze", {
    method: "POST",
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    status.innerText = "";
    document.getElementById("result").style.display = "block";

    document.getElementById("scoreText").innerText =
      `Match Score: ${data.match}% (${data.decision})`;

    document.getElementById("bar").style.width = `${data.match}%`;
    document.getElementById("summary").innerText = data.resume_summary;

    const verdict =
      data.match >= 70 ? "Shortlist" :
      data.match >= 50 ? "Review" : "Reject";

    const badge = document.getElementById("verdictBadge");
    badge.innerText = verdict;
    badge.className = "badge " +
      (verdict === "Shortlist" ? "shortlist" :
       verdict === "Review" ? "review" : "reject");

    const matched = document.getElementById("matched");
    const missing = document.getElementById("missing");
    const suggestions = document.getElementById("suggestions");

    matched.innerHTML = "";
    missing.innerHTML = "";
    suggestions.innerHTML = "";

    data.matched_skills.forEach(s =>
      matched.innerHTML += `<span class="skill matched">${s}</span>`
    );

    data.missing_skills.forEach(s => {
      missing.innerHTML += `<span class="skill missing">${s}</span>`;
      suggestions.innerHTML += `<li>Add experience in ${s}</li>`;
    });
  })
  .catch(() => {
    status.innerText = "Backend error. Is server running?";
  });
}
</script>

</body>
</html>
